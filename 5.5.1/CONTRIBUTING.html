<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Contributor guide | Libplanet </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Contributor guide | Libplanet ">
  
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="stylesheet" href="styles/docfx.vendor.css">
    <link rel="stylesheet" href="styles/docfx.css">
    <link rel="stylesheet" href="styles/main.css">
    <meta property="docfx:navrel" content="toc.html">
    <meta property="docfx:tocrel" content="toc.html">
  
  
  
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="index.html">
                <img id="logo" class="svg" src="images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="contributor-guide">Contributor guide</h1>

<p>Note: This document at present is for only code contributors.
We should expand it so that it covers reporting bugs, filing issues,
and writing docs.</p>
<h2 id="questions--online-chat--discord">Questions &amp; online chat  <a href="https://link.planetarium.dev/libplanet-contributing--pl-dev-discord"><img src="https://img.shields.io/discord/928926944937013338.svg?color=7289da&amp;logo=discord&amp;logoColor=white" alt="Discord"></a></h2>
<p>We have a <a href="https://link.planetarium.dev/libplanet-contributing--pl-dev-discord">Discord server</a> to discuss Libplanet.  There are some channels
for purposes in the <em>Libplanet</em> category:</p>
<ul>
<li><em>#libplanet-users</em>: Chat with game programmers who use Libplanet.
Ask questions to <em>use</em> Libplanet for your games.  People here usually
speak in Korean, but feel free to speak in English.</li>
<li><em>#libplanet-dev</em>: Chat with maintainers and contributors of Libplanet.
Ask questions to <em>hack</em> Libplanet and to make a patch for it.  People here
usually speak in Korean, but feel free to speak in English.</li>
</ul>
<h2 id="prerequisites">Prerequisites</h2>
<p>You need <a href="https://dot.net/">.NET Core</a> SDK 6.0+ which provides the latest C# compiler and .NET VM.
Read and follow the instruction to install .NET Core SDK on
the <a href="https://dotnet.microsoft.com/download">.NET Core downloads page</a>.
FYI if you use macOS and <a href="https://brew.sh/">Homebrew</a> you can install it by
<code>brew cask install dotnet-sdk</code> command.</p>
<p>Make sure that your .NET Core SDK is 6.0 or higher.  You could show
the version you are using by <code>dotnet --info</code> command.</p>
<p>Although it is not necessary, you should install a proper IDE for .NET
(or an <a href="http://www.omnisharp.net/">OmniSharp</a> extension for your favorite editor — except it takes
hours to properly configure and integrate with your editor).
C# is not like JavaScript or Python; it is painful to code in C# without IDE.</p>
<p>Unless you already have your favorite setup, we recommend you to use
<a href="https://code.visualstudio.com/">Visual Studio Code</a>.  It is free, open source, and made by Microsoft, which
made .NET as well.  So Visual Studio Code has a <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp">first-party C# extension</a>
which works well together.</p>
<h2 id="build">Build</h2>
<p>The following command installs dependencies (required library packages) and
builds the entire <em>Libplanet</em> solution:</p>
<pre><code>dotnet build
</code></pre>
<p>We use <a href="https://github.com/SonarSource/sonar-dotnet">SonarAnalyzer</a> to check our code quality but it takes longer to build.
To skip the analyzer, you can use:</p>
<pre><code>dotnet build -p:SkipSonar=true
</code></pre>
<h3 id="mono">Mono</h3>
<p>To build the solution with Mono, you must use the <em>ReleaseMono</em> solution
configuration. It is identical with <em>Release</em> target (creates built files
under <code>{bin,obj}/Release</code> directory), except that <em>ReleaseMono</em> excludes
projects with dependencies that are incompatible with Mono
(<em>Libplanet.Explorer*</em>):</p>
<pre><code>msbuild -restore -p:Configuration=ReleaseMono -p:TestsTargetFramework=net47
</code></pre>
<h2 id="projects">Projects</h2>
<p>The <a href="https://github.com/planetarium/libplanet">planetarium/libplanet</a> repository
on GitHub consists of several projects.  There are two types of projects:</p>
<ul>
<li>.NET projects under the umbrella of <em>Libplanet.sln</em></li>
<li>TypeScript/JavaScript project under the <a href="https://yarnpkg.com/features/workspaces">Yarn 3 workspace</a></li>
</ul>
<h3 id="net-projects">.NET projects</h3>
<ul>
<li><p><em>Libplanet</em>: The main project, which contains the most of implementation
code.  It is distributed as a NuGet package with the same name:
<em><a href="https://www.nuget.org/packages/Libplanet/">Libplanet</a></em>.</p>
</li>
<li><p><em>Libplanet.Common</em>: The common utilities and extensions for <em>Libplanet</em>.
This is distributed as a distinct NuGet package:
<em><a href="https://www.nuget.org/packages/Libplanet/">Libplanet.Common</a></em>.</p>
</li>
<li><p><em>Libplanet.Crypto</em>: The cryptography library for <em>Libplanet</em>.
This is distributed as a distinct NuGet package:
<em><a href="https://www.nuget.org/packages/Libplanet/">Libplanet.Crypto</a></em>.</p>
</li>
<li><p><em>Libplanet.Types</em>: The common types for <em>Libplanet</em>.
This is distributed as a distinct NuGet package:
<em><a href="https://www.nuget.org/packages/Libplanet/">Libplanet.Types</a></em>.</p>
</li>
<li><p><em>Libplanet.Store</em>: The store related functionalities for <em>Libplanet</em>.
This is distributed as a distinct NuGet package:
<em><a href="https://www.nuget.org/packages/Libplanet/">Libplanet.Store</a></em>.</p>
</li>
<li><p><em>Libplanet.Action</em>: The action evaluation layer for <em>Libplanet</em>.
This is distributed as a distinct NuGet package:
<em><a href="https://www.nuget.org/packages/Libplanet/">Libplanet.Action</a></em>.</p>
</li>
<li><p><em>Libplanet.Net</em>: The peer-to-peer networking layer built on top of
<em>Libplanet</em>.  This is distributed as a distinct NuGet package:
<em><a href="https://www.nuget.org/packages/Libplanet.Net/">Libplanet.Net</a></em>.</p>
</li>
<li><p><em>Libplanet.Stun</em>: The project dedicated to implement <a href="https://snack.planetarium.dev/eng/2019/06/nat_traversal_2/">TURN &amp; STUN</a>.
This is distributed as a distinct NuGet package: <em><a href="https://www.nuget.org/packages/Libplanet.Stun/">Libplanet.Stun</a></em>.</p>
</li>
<li><p><em>Libplanet.Crypto.Secp256k1</em>: The <code>ICryptoBackend&lt;T&gt;</code> implementation built
on native <a href="https://github.com/bitcoin-core/secp256k1">libsecp256k1</a>.  As this depends on a platform-dependent library
(which is written in C), this is distributed as a distinct NuGet package:
<em><a href="https://www.nuget.org/packages/Libplanet.Crypto.Secp256k1/">Libplanet.Crypto.Secp256k1</a></em>.</p>
</li>
<li><p><em>Libplanet.RocksDBStore</em>: The <code>IStore</code> implementation built on <a href="https://rocksdb.org/">RocksDB</a>.
As this depends on platform-dependent libraries (which is written in C/C++),
this is distributed as a distinct NuGet package: <em><a href="https://www.nuget.org/packages/Libplanet.RocksDBStore/">Libplanet.RocksDBStore</a></em>.</p>
</li>
<li><p><em>Libplanet.Store.Remote</em>: The <code>IKeyValueStore</code> implementation for use with
<em>Libplanet.Store</em> to store data in a remote server and communicate using
<a href="https://grpc.io/">gRPC</a>. This is cannot be used standalone. Need <code>IKeyValueStore</code>
implementation for local storage like <em><a href="https://www.nuget.org/packages/Libplanet.RocksDBStore/">Libplanet.RocksDBStore</a></em>.</p>
</li>
<li><p><em>Libplanet.Mocks</em>: A mocking tool to be used for development when
designing <code>IAction</code>s and writing test codes.  This should not be
used or referenced in production code.</p>
</li>
<li><p><em>Libplanet.Analyzers</em>: Roslyn Analyzer (i.e., lint) for game programmers who
use Libplanet.  This project is distributed as a distinct NuGet package:
<em><a href="https://www.nuget.org/packages/Libplanet.Analyzers/">Libplanet.Analyzers</a></em>.</p>
</li>
<li><p><em>Libplanet.Extensions.Cocona</em>: The project to provide the <a href="https://www.nuget.org/packages/Cocona">Cocona</a> commands
to handle <em>Libplanet</em> structures in command line.  This is  distributed as
a distinct NuGet package: <em><a href="https://www.nuget.org/packages/Libplanet.Extensions.Cocona">Libplanet.Extensions.Cocona</a></em>.</p>
</li>
<li><p><em>Libplanet.Tools</em>: The CLI tools for Libplanet.  This project is distributed
as a distinct NuGet package: <em><a href="https://www.nuget.org/packages/Libplanet.Tools/">Libplanet.Tools</a></em>. See its own
<a href="Libplanet.Tools/README.md">README.md</a>.</p>
</li>
<li><p><em>Libplanet.Explorer</em>: Libplanet Explorer, a web server that exposes
a Libplanet blockchain as a <a href="https://graphql.org/">GraphQL</a> endpoint.  There is the official
web front-end depending on this too: <a href="https://github.com/planetarium/libplanet-explorer-frontend">libplanet-explorer-frontend</a>.
Note that this project in itself is a library, and packaging it as
an executable is done by a below project named
<em>Libplanet.Explorer.Executable</em>.</p>
</li>
<li><p><em>Libplanet.Explorer.Cocona</em>: Provides <a href="https://www.nuget.org/packages/Cocona">Cocona</a> commands related to
<em>Libplanet.Explorer</em>.</p>
</li>
<li><p><em>Libplanet.Explorer.Executable</em>: (<strong>DEPRECATED</strong>) Turns Libplanet Explorer
into a single executable binary so that it is easy to distribute.</p>
</li>
<li><p><em>Libplanet.Benchmarks</em>: Performance benchmarks.
See the <a href="#benchmarks"><em>Benchmarks</em></a> section below.</p>
</li>
<li><p><em>Libplanet.Tests</em>: Unit tests for the <em>Libplanet</em> project.  See the <em>Tests</em>
section below.</p>
</li>
<li><p><em>Libplanet.Action.Tests</em>: Unit tests for the <em>Libplanet.Action</em> project.</p>
</li>
<li><p><em>Libplanet.Net.Tests</em>: Unit tests for the <em>Libplanet.Net</em> project.</p>
</li>
<li><p><em>Libplanet.Stun.Tests</em>: Unit tests of the <em>Libplanet.Stun</em> project.</p>
</li>
<li><p><em>Libplanet.Crypto.Secp256k1.Tests</em>: Unit tests for
the <em>Libplanet.Crypto.Secp256k1</em> project.</p>
</li>
<li><p><em>Libplanet.RocksDBStore.Tests</em>: Unit tests for the <em>Libplanet.RocksDBStore</em>
project.</p>
</li>
<li><p><em>Libplanet.Store.Remote.Tests</em>: Unit tests for the <em>Libplanet.Store.Remote</em>
project.</p>
</li>
<li><p><em>Libplanet.Analyzers.Tests</em>: Unit tests for the <em>Libplanet.Analyzers</em>
project.</p>
</li>
<li><p><em>Libplanet.Explorer.Tests</em>: Unit tests for the <em>Libplanet.Explorer</em>
project.</p>
</li>
<li><p><em>Libplanet.Explorer.Cocona.Tests</em>: Unit tests for the
<em>Libplanet.Explorer.Cocona</em> project.</p>
</li>
<li><p><em>Libplanet.Extensions.Cocona.Tests</em>: Unit tests for the
<em>Libplanet.Extensions.Cocona</em> project.</p>
</li>
</ul>
<h2 id="tests-build-status-circleci-codecov">Tests <a href="https://app.circleci.com/pipelines/github/planetarium/libplanet"><img src="https://circleci.com/gh/planetarium/libplanet/tree/main.svg?style=shield" alt="Build Status (CircleCI)"></a> <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp"><img src="https://codecov.io/gh/planetarium/libplanet/branch/main/graph/badge.svg" alt="Codecov"></a></h2>
<p>We write as complete tests as possible to the corresponding implementation code.
Going near to the <a href="https://codecov.io/gh/planetarium/libplanet">code coverage</a> 100% is one of our goals.</p>
<p>The <em>Libplanet</em> solution consists of several projects.
Every project without <em>.Tests</em> suffix is an actual implementation.
These are built to <em>Libplanet*.dll</em> assemblies and packed into one NuGet
package.</p>
<p><em>Libplanet*.Tests</em> is a test suite for the <em>Libplanet*.dll</em> assembly.
All of them depend on <a href="https://xunit.github.io/">Xunit</a>, and every namespace and class in these
corresponds to one in <em>Libplanet*</em> projects.
If there's <em>Libplanet.Foo.Bar</em> class there also should be
<em>Libplanet.Foo.Bar.Tests</em> to test it.</p>
<p>To build and run unit tests at a time with .NET Core execute the below command:</p>
<pre><code>dotnet test
</code></pre>
<p>To run unit tests with .NET Framework on Windows:</p>
<pre><code class="lang-pwsh">nuget install xunit.runner.console -Version 2.4.1
msbuild /restore /p:TestsTargetFramework=net472
&amp; (gci xunit.runner.console.*\tools\net472\xunit.console.exe | select -f 1) `
  (gci *.Tests\bin\Debug\net472\*.Tests.dll)
</code></pre>
<p>Or with Mono (As mentioned above in the <a href="#Mono">Mono</a> section, use
<em>ReleaseMono</em> solution configuration to avoid dependency issues):</p>
<pre><code class="lang-bash">nuget install xunit.runner.console
msbuild /restore /p:Configuration=ReleaseMono /p:TestsTargetFramework=net47
mono xunit.runner.console.*/tools/net47/xunit.console.exe \
    *.Tests/bin/Release/net47/*.Tests.dll
</code></pre>
<h3 id="turn_server_urls"><code>TURN_SERVER_URLS</code></h3>
<p>Some tests depend on a TURN server.  If <code>TURN_SERVER_URLS</code> environment variable
is present, these tests also run.  Otherwise, these tests are skipped.</p>
<p>As the name implies, <code>TURN_SERVER_URLS</code> can have more than one TURN server URL.
URLs are separated by whitespaces like <code>turn://user:password@host:3478/ turn://user:password@host2:3478/</code>.  If multiple TURN servers are provided,
each test case pick a random one to use so that loads are balanced.</p>
<p>FYI there are several TURN implementations like <a href="https://github.com/coturn/coturn">Coturn</a> and <a href="https://github.com/gortc/turn">gortc/turn</a>,
or cloud offers like <a href="https://xirsys.com/">Xirsys</a>.</p>
<h3 id="xunit-unity-runner"><a href="https://github.com/planetarium/xunit-unity-runner">xunit-unity-runner</a></h3>
<p>Unity is one of our platforms we primarily target to support, so we've been
testing Libplanet on the actual Unity runtime, and you could see whether it's
passed on <a href="https://app.circleci.com/pipelines/github/planetarium/libplanet">CircleCI</a>.</p>
<p>However, if it fails and it does not fail on other platforms but only Unity,
you need to run Unity tests on your own machine so that you rapidily and
repeatedly tinker things, make a try, and immediately get feedback from them.</p>
<p>Here's how to run Unity tests on your machine.  We've made and used
<a href="https://github.com/planetarium/xunit-unity-runner">xunit-unity-runner</a> to run <a href="https://xunit.github.io/">Xunit</a> tests on the actual Unity runtime,
and our build jobs on CircleCI also use this.  This test runner
is actually a Unity app, though it's not a game app.  As of June 2019,
there are <a href="https://github.com/planetarium/xunit-unity-runner/releases/latest">executable binaries</a> for Linux, macOS, and Windows.
Its usage is simple.  It's a CLI app that takes <em>absolute</em> paths to
.NET assemblies (<em>.dll</em>) that consist of test classes (based on Xunit).</p>
<p>You can build these assemblies using <code>msbuild -r</code> Mono or .NET Framework
provide.
<em>You can't build them using <code>dotnet build</code> command or <code>dotnet msbuild</code>,</em>
because the Unity runtime is not based on .NET Core but Mono,
which is compatible with .NET Framework 4.7.
Please be sure that Mono's <em>bin</em> directory is prior to .NET Core's one
(or it's okay too if .NET Core is not installed at all).  Mono or .NET
Framework's <code>msbuild</code> could try to use .NET Core's version of several
utilities during build, and this could cause some errors.
Also be aware that you must be building the solution with the <em>ReleaseMono</em>
configuration, as mentioned in the <a href="#Mono">Mono</a> section.</p>
<p>The way to execute the runner binary depend on the platform.  For details,
please read <a href="https://github.com/planetarium/xunit-unity-runner">xunit-unity-runner</a>'s README.  FYI you can use <code>-h</code>/<code>--help</code>
option as well.</p>
<p>To sum up, the instruction is like below (the example is assuming Linux):</p>
<pre><code>msbuild -r -p:Configuration=ReleaseMono -p:TestsTargetFramework=net47
xunit-unity-runner/StandaloneLinux64 \
  &quot;$PWD&quot;/*.Tests/bin/Release/net47/*.Tests.dll
</code></pre>
<h2 id="style-convention">Style convention</h2>
<p>Please follow the existing coding convention.  We are already using several
static analyzers.  They are automatically executed together with <code>msbuild</code>,
and will warn you if there are any style errors.</p>
<p>You should also register Git hooks we commonly use:</p>
<pre><code>git config core.hooksPath hooks
</code></pre>
<p>We highly recommend you to install an extension for <a href="https://editorconfig.org/">EditorConfig</a> in your
favorite editor.  Some recent editors have built-in support for EditorConfig,
e.g., Rider (IntelliJ IDEA), Visual Studio.  Many editors have an extension to
support EditorConfig, e.g., <a href="https://atom.io/packages/editorconfig">Atom</a>, <a href="https://github.com/editorconfig/editorconfig-emacs">Emacs</a>, <a href="https://github.com/editorconfig/editorconfig-vim">Vim</a>, <a href="https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig">VS Code</a>.</p>
<h2 id="benchmarks">Benchmarks</h2>
<p>In order to track performance improvements or regressions, we maintain a set of
benchmarks and continuously measure them in the CI.  You can run benchmarks
on your local environment too:</p>
<pre><code>dotnet run --project tools/Libplanet.Benchmarks -c Release -- -j short -f &quot;*&quot;
</code></pre>
<p>Note that there is <code>-j short</code>; without this a whole set of benchmarks takes
quite a long time.  This will print like below:</p>
<pre><code>|               Method | UnrollFactor |      Mean |      Error |    StdDev |
|--------------------- |------------- |----------:|-----------:|----------:|
|       MineBlockEmpty |           16 |  12.20 ms |  11.649 ms | 0.6385 ms |
|  MineBlockOneTran... |            1 |  14.54 ms |   3.602 ms | 0.1974 ms |
|                  ... |          ... |       ... |        ... |       ... |
</code></pre>
<p>You can measure only part of benchmarks by <code>-f</code>/<code>--filter</code>ing them:</p>
<pre><code>dotnet run --project tools/Libplanet.Benchmarks -c Release -- -j short-f &quot;*MineBlock*&quot;
</code></pre>
<p>All benchmark code is placed under <em>Libplanet.Benchmarks</em> project.
As our benchmarks are based on <a href="https://benchmarkdotnet.org/">BenchmarkDotNet</a>, please read their official
docs for details.</p>
<h2 id="releasing-a-new-version">Releasing a new version</h2>
<p>Read the <a href="RELEASE.html">Releasing guide</a> which dedicates to this topic.</p>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/planetarium/libplanet/blob/5.5.1/CONTRIBUTING.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      Copyright © 2018–2023 <a href="https://planetariumhq.com/">Planetarium</a>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
  </body>
</html>
